import{a as S,b,c as p,d as P,e as F,g as V,h as T,i as L,j as q,k as N,l as A}from"./chunk-ZVXIMTCJ.js";import{g as y}from"./chunk-EGNSODXE.js";import{$ as h,Ab as s,Hb as E,Ma as a,Y as f,bb as d,db as c,hb as m,ja as C,ka as g,lb as o,mb as n,nb as _,qb as w,sb as v,tb as u}from"./chunk-2FWFZOBT.js";function G(t,l){t&1&&(o(0,"p",8),s(1," Email is required "),n())}function D(t,l){t&1&&(o(0,"p",8),s(1," Enter Valid Email "),n())}function B(t,l){if(t&1&&(o(0,"div",6),d(1,G,2,0,"p",8)(2,D,2,0),n()),t&2){let i,e=u(2);a(),m(1,(i=e.verifyEmail.get("email"))!=null&&i.getError("required")?1:(i=e.verifyEmail.get("email"))!=null&&i.getError("email")?2:-1)}}function M(t,l){t&1&&(o(0,"span"),_(1,"i",9),n())}function R(t,l){if(t&1){let i=w();o(0,"form",2),v("ngSubmit",function(){C(i);let r=u();return g(r.verifyEmailSubmit())}),o(1,"div",3)(2,"label",4),s(3,"please enter your email "),n(),_(4,"input",5),d(5,B,3,1,"div",6),n(),o(6,"button",7),s(7," Verify "),d(8,M,2,0,"span"),n()()}if(t&2){let i,e=u();c("formGroup",e.verifyEmail),a(5),m(5,(i=e.verifyEmail.get("email"))!=null&&i.errors&&((i=e.verifyEmail.get("email"))!=null&&i.touched||(i=e.verifyEmail.get("email"))!=null&&i.dirty)?5:-1),a(),c("disabled",e.verifyEmail.invalid),a(2),m(8,e.isLoading?8:-1)}}function k(t,l){t&1&&(o(0,"p",8),s(1," resetCode is required "),n())}function $(t,l){t&1&&(o(0,"p",8),s(1," Enter Valid resetCode "),n())}function j(t,l){if(t&1&&(o(0,"div",6),d(1,k,2,0,"p",8)(2,$,2,0),n()),t&2){let i,e=u(2);a(),m(1,(i=e.verifyCode.get("resetCode"))!=null&&i.getError("required")?1:(i=e.verifyCode.get("resetCode"))!=null&&i.getError("pattern")?2:-1)}}function I(t,l){t&1&&(o(0,"span"),_(1,"i",9),n())}function O(t,l){if(t&1){let i=w();o(0,"form",2),v("ngSubmit",function(){C(i);let r=u();return g(r.verifyCodeSubmit())}),o(1,"div",3)(2,"label",10),s(3,"please enter your verification code "),n(),_(4,"input",11),d(5,j,3,1,"div",6),n(),o(6,"button",7),s(7," Verify "),d(8,I,2,0,"span"),n()()}if(t&2){let i,e=u();c("formGroup",e.verifyCode),a(5),m(5,(i=e.verifyCode.get("resetCode"))!=null&&i.errors&&((i=e.verifyCode.get("resetCode"))!=null&&i.touched||(i=e.verifyCode.get("resetCode"))!=null&&i.dirty)?5:-1),a(),c("disabled",e.verifyCode.invalid),a(2),m(8,e.isLoading?8:-1)}}function U(t,l){t&1&&(o(0,"p",8),s(1," Email is required "),n())}function z(t,l){t&1&&(o(0,"p",8),s(1," Enter Valid Email "),n())}function H(t,l){if(t&1&&(o(0,"div",6),d(1,U,2,0,"p",8)(2,z,2,0),n()),t&2){let i,e=u(2);a(),m(1,(i=e.resetPassword.get("email"))!=null&&i.getError("required")?1:(i=e.resetPassword.get("email"))!=null&&i.getError("email")?2:-1)}}function J(t,l){t&1&&(o(0,"p",8),s(1," Password is required "),n())}function K(t,l){t&1&&(o(0,"p",8),s(1," must be at least 6 chars "),n())}function Q(t,l){if(t&1&&(o(0,"div",6),d(1,J,2,0,"p",8)(2,K,2,0),n()),t&2){let i,e=u(2);a(),m(1,(i=e.resetPassword.get("newPassword"))!=null&&i.getError("required")?1:(i=e.resetPassword.get("newPassword"))!=null&&i.getError("pattern")?2:-1)}}function W(t,l){t&1&&(o(0,"span"),_(1,"i",9),n())}function X(t,l){if(t&1){let i=w();o(0,"form",2),v("ngSubmit",function(){C(i);let r=u();return g(r.resetPasswordSubmit())}),o(1,"div",3)(2,"label",4),s(3,"please enter your email "),n(),_(4,"input",12),d(5,H,3,1,"div",6),n(),o(6,"div",3)(7,"label",13),s(8," newPassword: "),n(),_(9,"input",14),d(10,Q,3,1,"div",6),n(),o(11,"button",7),s(12," Verify "),d(13,W,2,0,"span"),n()()}if(t&2){let i,e,r=u();c("formGroup",r.resetPassword),a(5),m(5,(i=r.resetPassword.get("email"))!=null&&i.errors&&((i=r.resetPassword.get("email"))!=null&&i.touched||(i=r.resetPassword.get("email"))!=null&&i.dirty)?5:-1),a(5),m(10,(e=r.resetPassword.get("newPassword"))!=null&&e.errors&&((e=r.resetPassword.get("newPassword"))!=null&&e.touched||(e=r.resetPassword.get("newPassword"))!=null&&e.dirty)?10:-1),a(),c("disabled",r.resetPassword.invalid),a(2),m(13,r.isLoading?13:-1)}}var re=(()=>{let l=class l{constructor(){this._FormBuilder=f(q),this._AuthService=f(S),this._Router=f(y),this.step=1,this.isLoading=!1,this.msgError="",this.verifyEmail=this._FormBuilder.group({email:[null,[p.required,p.email]]}),this.verifyCode=this._FormBuilder.group({resetCode:[null,[p.required,p.pattern(/^[0-9]{6}$/)]]}),this.resetPassword=this._FormBuilder.group({email:[null,[p.required,p.email]],newPassword:[null,[p.required,p.pattern(/^\w{6,}$/)]]})}verifyEmailSubmit(){if(this.verifyEmail.valid){this.isLoading=!0;let e=this.verifyEmail.get("email")?.value;this.resetPassword.get("email")?.patchValue(e),this.VerifyEmailSubscription=this.VerifyEmailSubscription=this._AuthService.setverifyEmail(this.verifyEmail.value).subscribe({next:r=>{console.log(r),r.statusMsg==="success"&&(this.step=2,this.isLoading=!1)},error:r=>{this.msgError=r.error.message,console.log(r),this.isLoading=!1}})}}verifyCodeSubmit(){this.verifyCode.valid&&(this.isLoading=!0,this.VerifyCodeSubscription=this.VerifyCodeSubscription=this._AuthService.verifyCode(this.verifyCode.value).subscribe({next:e=>{console.log(e),e.status==="Success"&&(this.step=3,this.isLoading=!1)},error:e=>{this.msgError=e.error.message,console.log(e),this.isLoading=!1}}))}resetPasswordSubmit(){this.resetPassword.valid&&(this.isLoading=!0,this.resetPasswordSubscription=this.resetPasswordSubscription=this._AuthService.resetPass(this.resetPassword.value).subscribe({next:e=>{console.log(e),this.isLoading=!1,localStorage.setItem("userToken",e.token),this._AuthService.saveUserData(),this._Router.navigate(["/home"])},error:e=>{this.msgError=e.error.message,console.log(e),this.isLoading=!1}}))}ngOnDestroy(){this.VerifyEmailSubscription?.unsubscribe(),this.VerifyCodeSubscription?.unsubscribe(),this.resetPasswordSubscription?.unsubscribe()}};l.\u0275fac=function(r){return new(r||l)},l.\u0275cmp=h({type:l,selectors:[["app-forgetpassword"]],standalone:!0,features:[E],decls:4,vars:1,consts:[[1,"py-5"],[1,"p-3",3,"formGroup"],[1,"p-3",3,"ngSubmit","formGroup"],[1,"my-2"],["for","email",1,"h2","fw-bold"],["type","email","formControlName","email","id","email",1,"form-control"],[1,"alert","alert-danger","my-3","text-danger"],["type","submit",1,"btn-main","ms-auto","d-block",3,"disabled"],[1,"m-0"],[1,"fas","fa-spin","fa-spinner"],["for","code",1,"h2","fw-bold"],["type","text","formControlName","resetCode","id","code",1,"form-control"],["type","email","readonly","","formControlName","email","id","email",1,"form-control"],["for","newPassword"],["type","password","name","newPassword","id","newPassword","formControlName","newPassword",1,"form-control"]],template:function(r,x){r&1&&(o(0,"section",0),d(1,R,9,4,"form",1)(2,O,9,4)(3,X,14,5),n()),r&2&&(a(),m(1,x.step===1?1:x.step===2?2:x.step===3?3:-1))},dependencies:[A,V,b,P,F,T,L,N]});let t=l;return t})();export{re as ForgetpasswordComponent};
